<div class="d-flex align-items-stretch justify-content-between" *ngIf="file">
  <div style="width: 5%;">
    <button class="btn btn-link" style="cursor: pointer;"
      [routerLink]="'/user/files'" [tooltip]="t(' Back to List')">
      <i class="fas fa-long-arrow-alt-left"></i>
    </button>
  </div>
  <div (click)="markFavorite(file)" style="cursor: pointer; width: 2%;" class="align-self-start">
    <i *ngIf="getBool(file.pin)" class="fa fa-star"></i>
    <i *ngIf="!getBool(file.pin)" class="far fa-star"></i>
  </div>
  <div class="d-flex flex-column  justify-content-between align-self-scratch" style="width: 20%;">
    <div class="d-inline-block text-truncate">
      {{file.filename}}
    </div>
    <div class="d-inline-block text-truncate font-weight-bold mt-2">
      {{file.batchid}}
    </div>
  </div>
  <div class="d-flex flex-column  justify-content-between align-self-scratch px-4" style="width: 20%;">
    <div class="d-flex flex-row justify-content-end align-items-center">
      <span class="badge badge-secondary mr-1" *ngFor="let tag of file.tags">{{tag}}</span>
      <button class="btn p-0 c-normal" style="cursor: pointer;" (click)="showModal(tagModal, file)"
        tooltip="{{t('Edit tags')}}">
        <i class="fa fa-pencil-alt"></i>
      </button>
    </div>
    <div class="mt-1" *ngIf="file.topic">
      <i class="fas fa-quote-left mr-1"></i>{{file.topic.topic}}<span
        class="font-weight-bold ml-1">{{file.topic.confidence}} %</span>
    </div>
  </div>
  <div class="d-flex flex-row justify-content-start" style="width: 10%;">
    <div class="pr-4" style="font-size: xx-small;">
      <div class="mb-1">
        <span class="mr-2">{{t('Uploaded')}}</span>
        <span class="float-right font-weight-bold">{{file.uploaddate | date: 'dd/MM/yyyy'}}</span>
      </div>
      <div class="mb-1">
        <span class="mr-2">{{t('Duration')}}</span>
        <span class="float-right font-weight-bold">{{ getFormatedTime(file.duration)}}</span>
      </div>
      <div class="mb-1">
        <span class="mr-2"> {{t('Silence')}}</span>
        <span *ngIf="file.pause && file.pause.dur"
          class="float-right font-weight-bold">{{getFormatedTime(file.pause.dur)}}
          ({{file.pause.dur / file.duration | percent}})</span>
      </div>
    </div>
  </div>
  <div class="d-flex justify-content-center align-self-scratch" style="width: 10%;">
    <div class="d-flex flex-column px-2">
      <div style="font-size: x-small;" class="mb-3 font-weight-bold">{{t('Compliance')}}:</div>
      <div class="d-flex flex-row">
        <div class="align-self-center text-center mr-1">
          <i class="fa fa-shield-alt"></i>
        </div>
        <div class="m-0" [ngStyle]="{'color': getOpacityLevelCompliance(file.compliancepercent), 'width': '4rem'}">
          {{file.compliancepercent !== '-' ? abs(file.compliancepercent) + '%' : '-  ' }}
        </div>
      </div>
    </div>
  </div>
  <div class="d-flex justify-content-center align-self-scratch" style="width: 10%;">
    <div class="d-flex flex-column px-2">
      <div style="font-size: x-small;" class="mb-3 font-weight-bold">{{t('Sentiment trend')}}:</div>
      <ng-container *ngIf="hasTrend(file.sentimentTrend); else emptyTrend">
        <div class="d-flex flex-row align-self-center mt-1">
          <i class="far " [ngClass]='getTrend(file.sentimentTrend.start)' [tooltip]="file.sentimentTrend.start"></i>
          <i class="fas fa-long-arrow-alt-right mx-2"></i>
          <i [ngClass]='getTrend(file.sentimentTrend.end)' [tooltip]="file.sentimentTrend.end" class="far "></i>
        </div>
      </ng-container>
      <ng-template #emptyTrend>
        <div class="d-flex flex-row align-self-start">
          <div style="width: 4rem">
            -
          </div>
        </div>
      </ng-template>
    </div>
  </div>
  <div class="d-flex justify-content-center align-self-scratch" style="width: 10%;"
    [ngStyle]="{'background': getOpacityLevelAnger(file.angertop)}">
    <div class="d-flex flex-column pt-2">
      <div style="font-size: x-small;" class="mb-3 font-weight-bold">{{t('Average emotional level')}}:
      </div>
      <div class="d-flex flex-row">
        <div class="align-self-center text-center mr-1"><i class="fa fa-thermometer-empty"></i>
        </div>
        <div class="m-0" *ngIf="file.angertop && file.angertop.anger; else empty">
          {{file.angertop && file.angertop.anger}}%
        </div>
        <ng-template #empty>
          <div style="width: 4rem;">
            -
          </div>
        </ng-template>
      </div>
    </div>
  </div>
  <div class="d-flex flex-column" style="width: 10%;">
    <div class="d-inline-block text-center">
      {{fileIndex + 1}} out of {{filterService.totalcount}}
    </div>
  </div>
  <div class="d-flex flex-row justify-content-center align-self-scratch" style="width: 5%;">
    <button class="btn btn-link" style="cursor: pointer;" [disabled]="filterService.hasPrevLink(fileName, batchId)"
      [routerLink]="filterService.getPrevLink(fileName, batchId)" [tooltip]="t('Previous File')">
      <i class="fas fa-chevron-left"></i>
    </button>
    <button class="btn btn-link ml-2" style="cursor: pointer;" [disabled]="filterService.hasNextLink(fileName, batchId)"
      [routerLink]="filterService.getNextLink(fileName, batchId)" [tooltip]="t('Next File')">
      <i class="fas fa-chevron-right"></i>
    </button>
  </div>
</div>
<ng-template #loading>
  loading...
</ng-template>
<ng-template #tagModal>
  <div class="modal-header">
    {{t('Tags')}}
    <button type="button" class="close pull-right" aria-label="Close" (click)="hideModal()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body tagsModal">
    <tag-input [(ngModel)]="itemTags" [editable]="true" theme="minimal" placeholder="{{t('Add Tag')}}"
      secondaryPlaceholder="{{t('Add Tag')}}" [separatorKeys]="[',']" [separatorKeyCodes]="[13]"></tag-input>
    <div class="text-right">
      <button class="btn btn-primary mr-3" (click)="saveTags()">{{t('Save')}}</button>
      <button class="btn btn-link btn-secondary" (click)="hideModal()">{{t('Close')}}</button>
    </div>
  </div>
</ng-template>