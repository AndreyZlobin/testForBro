<nb-card>
  <nb-card-body>
    <div>
      <div class="alert alert-danger" *ngIf="errorMessage">
        {{ t("Error:") }} {{ t(errorMessage) }}
      </div>
      <div>
        <div class="d-flex flex-row py-1">
          <button class="btn btm-sm btn-secondary mr-2" style="cursor: pointer;"
            [disabled]=" filterService.hasPrevLink(fileParams.filename, fileParams.batchid)"
            [routerLink]="filterService.getPrevLink(fileParams.filename, fileParams.batchid)">
            <i class="fas fa-chevron-left"></i>
          </button>
          <button class="btn btm-sm btn-secondary mr-2" style="cursor: pointer;"
            [disabled]="filterService.hasNextLink(fileParams.filename, fileParams.batchid)"
            [routerLink]="filterService.getNextLink(fileParams.filename, fileParams.batchid)">
            <i class="fas fa-chevron-right"></i>
          </button>
          <h2 class="text-truncate my-2" style="max-width: 56vw;">
            {{ fileParams.filename }}
          </h2>
          <button class="btn btm-sm btn-secondary ml-auto" style="cursor: pointer;" routerLink="/user/files">
            {{ t("Back to List") }}
          </button>
        </div>
      </div>
      <nb-tabset (changeTab)="changeTab($event)" *ngIf="currentView">
        <nb-tab tabTitle="Player" [active]="currentView === 'player'">
        </nb-tab>
        <nb-tab tabTitle="Analytics" [active]="currentView === 'analytic'">
        </nb-tab>
      </nb-tabset>
      <div class="d-flex flex-column" *ngIf="currentView === 'player'">
        <ng-container *ngIf="fileParams.filename && fileParams.batchid; else empty">
          <ngx-player [fileName]="fileParams.filename" [batchId]="fileParams.batchid"></ngx-player>
        </ng-container>
        <div style="overflow-y: auto;">
          <div style="height: 56vh;">
            <ngx-text-log [batchId]="fileParams.batchid" [fileName]="fileParams.filename"
              (goToRegion)="goToRegion($event)"></ngx-text-log>
          </div>
        </div>
      </div>
      <div class="row" *ngIf="currentView === 'analytic'">
        <div class="col-12 mb-3">
          <div class="card">
            <div class="card-header">{{t('Text')}}</div>
            <div class="card-body">
              <div class="mt-2">
                <ngx-full-text [batchId]="fileParams.batchid" [fileName]="fileParams.filename"></ngx-full-text>
              </div>
            </div>
          </div>
        </div>
        <div class="col-6 mb-3">
          <div class="card">
            <div class="card-header">{{t('Stopwords')}}</div>
            <div class="card-body p-0">
              <ngx-text-stopwords [batchId]="fileParams.batchid" [fileName]="fileParams.filename"></ngx-text-stopwords>
            </div>
          </div>
        </div>
        <div class="col-6 mb-3">
          <ngx-text-compliance [batchId]="fileParams.batchid" [fileName]="fileParams.filename"></ngx-text-compliance>
        </div>
        <div class="col-6 mb-3">
          <div class="card">
            <div class="card-header">{{t('Sankey Diagram')}}</div>
            <div class="card-body">
              <ngx-text-sankey [batchId]="fileParams.batchid" [fileName]="fileParams.filename"></ngx-text-sankey>
            </div>
          </div>
        </div>
        <div class="col-6 mb-3">
          <div class="card">
            <div class="card-header">{{t('Keywords and phases')}}</div>
            <div class="card-body">
              <ngx-text-keywords [batchId]="fileParams.batchid" [fileName]="fileParams.filename"></ngx-text-keywords>
            </div>
          </div>
        </div>
        <div class="col-6 mb-3">
          <div class="card">
            <div class="card-header">{{t('Most frequency used words')}}</div>
            <div class="card-body p-0">
              <ngx-text-tag-cloud [batchId]="fileParams.batchid" [fileName]="fileParams.filename"></ngx-text-tag-cloud>
            </div>
          </div>
        </div>
        <div class="col-6 mb-3">
          <div class="card">
            <div class="card-header">{{t('Hits vs words')}}</div>
            <div class="card-body">
              <ngx-text-hits-words [batchId]="fileParams.batchid" [fileName]="fileParams.filename">
              </ngx-text-hits-words>
            </div>
          </div>
        </div>
      </div>
      <ng-template #loading>
        {{ t("Loading...") }}
      </ng-template>
    </div>
  </nb-card-body>
</nb-card>